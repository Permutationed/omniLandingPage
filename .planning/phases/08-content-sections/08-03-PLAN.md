---
phase: 08-content-sections
plan: 03
type: execute
wave: 1
depends_on: []
files_modified:
  - components/content-sections/discovery-preview/phone-mockup.tsx
  - components/content-sections/discovery-preview/map-preview.tsx
  - components/content-sections/discovery-preview/discovery-preview.tsx
  - components/content-sections/discovery-preview/index.ts
autonomous: true

must_haves:
  truths:
    - "User sees phone mockup displaying map UI"
    - "User sees merchant markers on the map"
    - "User sees proximity notification preview"
    - "Phone mockup looks like modern smartphone (dynamic island)"
  artifacts:
    - path: "components/content-sections/discovery-preview/phone-mockup.tsx"
      provides: "Pure CSS phone frame component"
      exports: ["PhoneMockup"]
    - path: "components/content-sections/discovery-preview/map-preview.tsx"
      provides: "Simplified map UI for phone screen"
      exports: ["MapPreview"]
    - path: "components/content-sections/discovery-preview/discovery-preview.tsx"
      provides: "Full discovery preview section with phone and notification"
      exports: ["DiscoveryPreview"]
  key_links:
    - from: "components/content-sections/discovery-preview/discovery-preview.tsx"
      to: "components/content-sections/discovery-preview/phone-mockup.tsx"
      via: "PhoneMockup component"
      pattern: "<PhoneMockup"
    - from: "components/content-sections/discovery-preview/discovery-preview.tsx"
      to: "components/how-you-earn/discover-rewards/notification-toast.tsx"
      via: "Reuse NotificationToast"
      pattern: "import.*NotificationToast"
---

<objective>
Create the Discovery Preview section showing a phone mockup with map UI and proximity notification.

Purpose: Visually demonstrate the discovery feature - how students find nearby merchants and receive notifications about boosted rewards.

Output: DiscoveryPreview section with phone mockup, map preview, and notification toast ready for page integration.
</objective>

<execution_context>
@~/.claude/get-shit-done/workflows/execute-plan.md
@~/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/08-content-sections/08-RESEARCH.md

# Reusable components
@components/how-you-earn/discover-rewards/notification-toast.tsx
@components/how-you-earn/shared/constants.ts
</context>

<tasks>

<task type="auto">
  <name>Task 1: Create PhoneMockup and MapPreview components</name>
  <files>
    components/content-sections/discovery-preview/phone-mockup.tsx
    components/content-sections/discovery-preview/map-preview.tsx
  </files>
  <action>
1. Create `components/content-sections/discovery-preview/phone-mockup.tsx`:

Pure CSS phone mockup - no external dependencies.

```typescript
import { ReactNode } from 'react'

interface PhoneMockupProps {
  children: ReactNode
  className?: string
}

export function PhoneMockup({ children, className = '' }: PhoneMockupProps) {
  return (
    <div className={`relative mx-auto w-[280px] ${className}`}>
      {/* Phone frame - dark bezel */}
      <div className="relative rounded-[40px] border-[8px] border-foreground/90 bg-background overflow-hidden shadow-2xl">
        {/* Dynamic Island */}
        <div className="absolute top-2 left-1/2 -translate-x-1/2 w-24 h-6 bg-foreground/90 rounded-full z-20" />

        {/* Screen content - aspect ratio matches iPhone 14/15 */}
        <div className="aspect-[9/19.5] overflow-hidden">
          {children}
        </div>

        {/* Home indicator */}
        <div className="absolute bottom-2 left-1/2 -translate-x-1/2 w-32 h-1 bg-foreground/30 rounded-full z-20" />
      </div>
    </div>
  )
}
```

2. Create `components/content-sections/discovery-preview/map-preview.tsx`:

Simplified map for phone screen - cleaner than IsometricMap, more "app-like".

'use client' directive (for animation)

```typescript
import { motion } from 'motion/react'
import { Coffee, BookOpen, Pizza, ShoppingBag } from 'lucide-react'
import { ISO_COLORS } from '@/components/how-you-earn/shared/constants'

const merchants = [
  { id: 1, name: 'Campus Coffee', icon: Coffee, x: 30, y: 35, multiplier: 5 },
  { id: 2, name: 'Book Nook', icon: BookOpen, x: 65, y: 25, multiplier: 3 },
  { id: 3, name: 'Pizza Place', icon: Pizza, x: 55, y: 60, multiplier: 7 },
  { id: 4, name: 'Campus Store', icon: ShoppingBag, x: 25, y: 70, multiplier: 4 },
]

export function MapPreview() {
  return (
    <div className="relative w-full h-full bg-gradient-to-br from-emerald-50 to-emerald-100 pt-10">
      {/* Map header bar */}
      <div className="absolute top-10 left-0 right-0 bg-background/95 backdrop-blur-sm px-4 py-3 border-b border-border z-10">
        <div className="flex items-center gap-2">
          <div className="w-2 h-2 rounded-full bg-primary animate-pulse" />
          <span className="text-xs font-medium">Discover nearby rewards</span>
        </div>
      </div>

      {/* Simplified map grid */}
      <svg className="absolute inset-0 w-full h-full" preserveAspectRatio="xMidYMid slice">
        <defs>
          <pattern id="mapGrid" width="30" height="30" patternUnits="userSpaceOnUse">
            <path d="M 30 0 L 0 0 0 30" fill="none" stroke="rgba(0,0,0,0.05)" strokeWidth="1"/>
          </pattern>
        </defs>
        <rect width="100%" height="100%" fill="url(#mapGrid)" />

        {/* "Roads" */}
        <line x1="50%" y1="0" x2="50%" y2="100%" stroke="rgba(0,0,0,0.1)" strokeWidth="8"/>
        <line x1="0" y1="50%" x2="100%" y2="50%" stroke="rgba(0,0,0,0.1)" strokeWidth="8"/>
      </svg>

      {/* User location (center) */}
      <div className="absolute left-1/2 top-1/2 -translate-x-1/2 -translate-y-1/2 z-10">
        <motion.div
          className="w-6 h-6 rounded-full bg-primary/20"
          animate={{ scale: [1, 1.5, 1], opacity: [0.5, 0.2, 0.5] }}
          transition={{ duration: 2, repeat: Infinity }}
        />
        <div className="absolute inset-0 m-auto w-3 h-3 rounded-full bg-primary border-2 border-white shadow-lg" />
      </div>

      {/* Merchant pins */}
      {merchants.map((merchant, index) => (
        <motion.div
          key={merchant.id}
          className="absolute z-10"
          style={{ left: `${merchant.x}%`, top: `${merchant.y}%` }}
          initial={{ scale: 0, y: -10 }}
          animate={{ scale: 1, y: 0 }}
          transition={{ delay: 0.5 + index * 0.15, type: 'spring', bounce: 0.4 }}
        >
          <div className="relative -translate-x-1/2 -translate-y-1/2">
            {/* Pin body */}
            <div className="w-8 h-8 rounded-full bg-white shadow-lg border border-border flex items-center justify-center">
              <merchant.icon className="w-4 h-4 text-primary" />
            </div>
            {/* Multiplier badge */}
            <div className="absolute -top-1 -right-1 w-4 h-4 rounded-full bg-amber-500 text-white text-[8px] font-bold flex items-center justify-center shadow-sm">
              {merchant.multiplier}x
            </div>
          </div>
        </motion.div>
      ))}
    </div>
  )
}
```

Key differences from IsometricMap:
- Simpler grid (not isometric)
- App-like header bar
- Staggered pin reveal animation (no scroll dependency)
- Multiplier badges on pins
  </action>
  <verify>
    - TypeScript compiles: `npx tsc --noEmit`
    - Files exist: `ls components/content-sections/discovery-preview/phone-mockup.tsx components/content-sections/discovery-preview/map-preview.tsx`
    - PhoneMockup is pure (no 'use client'): `grep -L "'use client'" components/content-sections/discovery-preview/phone-mockup.tsx`
    - MapPreview has animations: `grep -l "motion" components/content-sections/discovery-preview/map-preview.tsx`
  </verify>
  <done>
    - PhoneMockup renders pure CSS phone frame with dynamic island
    - MapPreview shows simplified map grid with user location pulse
    - 4 merchant pins animate in with stagger
    - Pins show multiplier badges (3x, 4x, 5x, 7x)
  </done>
</task>

<task type="auto">
  <name>Task 2: Create DiscoveryPreview section with notification</name>
  <files>
    components/content-sections/discovery-preview/discovery-preview.tsx
    components/content-sections/discovery-preview/index.ts
  </files>
  <action>
1. Create `components/content-sections/discovery-preview/discovery-preview.tsx`:

'use client' directive

Import:
- motion from 'motion/react'
- ScrollReveal from '@/components/ui/scroll-reveal'
- PhoneMockup from './phone-mockup'
- MapPreview from './map-preview'
- Coffee from 'lucide-react' (for notification)
- slideUpVariants from '@/lib/animation-variants'

Note: We'll create a simplified static notification instead of reusing NotificationToast (which requires MotionValue progress). This is simpler and cleaner for the preview context.

```typescript
export function DiscoveryPreview() {
  return (
    <section className="py-20 sm:py-24 bg-muted/30">
      <div className="max-w-6xl mx-auto px-4">
        {/* Header */}
        <ScrollReveal className="text-center mb-12">
          <h2 className="font-display text-3xl sm:text-4xl font-bold mb-4">
            Discover Local Rewards
          </h2>
          <p className="text-muted-foreground text-lg max-w-2xl mx-auto">
            Find partner merchants near campus and earn 3x-10x points on everyday purchases.
          </p>
        </ScrollReveal>

        {/* Content: Phone + Description */}
        <div className="flex flex-col lg:flex-row items-center gap-12 lg:gap-16">
          {/* Phone mockup */}
          <ScrollReveal
            variants={slideUpVariants}
            className="flex-shrink-0"
          >
            <PhoneMockup>
              <MapPreview />
            </PhoneMockup>
          </ScrollReveal>

          {/* Description + Notification */}
          <div className="flex-1 max-w-lg">
            <ScrollReveal variants={slideUpVariants}>
              {/* Feature list */}
              <div className="space-y-4 mb-8">
                <div className="flex items-start gap-3">
                  <div className="w-6 h-6 rounded-full bg-primary/10 flex items-center justify-center flex-shrink-0 mt-0.5">
                    <span className="text-primary text-xs font-bold">1</span>
                  </div>
                  <div>
                    <h3 className="font-semibold mb-1">Open the Omni app</h3>
                    <p className="text-muted-foreground text-sm">See partner merchants on the map with their reward multipliers.</p>
                  </div>
                </div>
                <div className="flex items-start gap-3">
                  <div className="w-6 h-6 rounded-full bg-primary/10 flex items-center justify-center flex-shrink-0 mt-0.5">
                    <span className="text-primary text-xs font-bold">2</span>
                  </div>
                  <div>
                    <h3 className="font-semibold mb-1">Get proximity alerts</h3>
                    <p className="text-muted-foreground text-sm">Receive notifications when you're near a merchant with boosted rewards.</p>
                  </div>
                </div>
                <div className="flex items-start gap-3">
                  <div className="w-6 h-6 rounded-full bg-primary/10 flex items-center justify-center flex-shrink-0 mt-0.5">
                    <span className="text-primary text-xs font-bold">3</span>
                  </div>
                  <div>
                    <h3 className="font-semibold mb-1">Pay with Omni</h3>
                    <p className="text-muted-foreground text-sm">Earn multiplied points automatically. No codes, no hassle.</p>
                  </div>
                </div>
              </div>
            </ScrollReveal>

            {/* Static notification preview */}
            <motion.div
              initial={{ opacity: 0, y: 20 }}
              whileInView={{ opacity: 1, y: 0 }}
              viewport={{ once: true, amount: 0.5 }}
              transition={{ delay: 0.4, duration: 0.5 }}
            >
              <div className="bg-background border border-border rounded-xl shadow-xl overflow-hidden">
                <div className="h-1 bg-gradient-to-r from-primary via-green-500 to-amber-500" />
                <div className="p-4 flex items-center gap-4">
                  <div className="w-10 h-10 rounded-full bg-primary/10 flex items-center justify-center flex-shrink-0">
                    <svg className="w-5 h-5 text-primary" fill="none" viewBox="0 0 24 24" stroke="currentColor" strokeWidth={2}>
                      <path strokeLinecap="round" strokeLinejoin="round" d="M17.657 16.657L13.414 20.9a1.998 1.998 0 01-2.827 0l-4.244-4.243a8 8 0 1111.314 0z" />
                      <path strokeLinecap="round" strokeLinejoin="round" d="M15 11a3 3 0 11-6 0 3 3 0 016 0z" />
                    </svg>
                  </div>
                  <div className="flex-1 min-w-0">
                    <p className="text-sm font-medium">You're near Campus Coffee</p>
                    <p className="text-xs text-muted-foreground">
                      Earn <span className="font-bold text-primary">5x points</span> today
                    </p>
                  </div>
                  <div className="w-10 h-10 rounded-lg bg-muted flex items-center justify-center flex-shrink-0">
                    <Coffee className="w-5 h-5 text-foreground" />
                  </div>
                </div>
              </div>
            </motion.div>
          </div>
        </div>
      </div>
    </section>
  )
}
```

2. Create `components/content-sections/discovery-preview/index.ts`:
```typescript
export { DiscoveryPreview } from './discovery-preview'
export { PhoneMockup } from './phone-mockup'
export { MapPreview } from './map-preview'
```
  </action>
  <verify>
    - TypeScript compiles: `npx tsc --noEmit`
    - File exists: `ls components/content-sections/discovery-preview/discovery-preview.tsx`
    - Index exports: `grep -l "DiscoveryPreview" components/content-sections/discovery-preview/index.ts`
    - Notification present: `grep -l "Campus Coffee" components/content-sections/discovery-preview/discovery-preview.tsx`
  </verify>
  <done>
    - DiscoveryPreview section has header, phone mockup, and description
    - Phone shows MapPreview with animated merchant pins
    - 3-step feature list explains the discovery flow
    - Proximity notification preview shows "Campus Coffee - 5x points"
    - Section ready for page integration
  </done>
</task>

</tasks>

<verification>
1. TypeScript compiles without errors: `npx tsc --noEmit`
2. PhoneMockup uses pure CSS (no library dependencies)
3. MapPreview has staggered pin animations
4. Notification preview matches existing design language
5. Responsive layout: stacked on mobile, side-by-side on desktop
6. ScrollReveal animations on scroll into view
</verification>

<success_criteria>
- Phone mockup renders with dynamic island and home indicator
- Map inside phone shows 4 merchant pins with multiplier badges
- Pins animate in with stagger effect
- 3-step discovery process is explained
- Proximity notification preview shows example merchant
- Section is responsive (phone centered on mobile)
- Component exports ready for page integration
</success_criteria>

<output>
After completion, create `.planning/phases/08-content-sections/08-03-SUMMARY.md`
</output>
