---
phase: 02-layout-components
plan: 02
type: execute
wave: 2
depends_on: ["02-01"]
files_modified:
  - components/ui/magnetic-button.tsx
  - components/layout/mobile-nav.tsx
  - components/layout/header-nav.tsx
  - components/layout/header.tsx
autonomous: true

must_haves:
  truths:
    - "User sees sticky navigation on scroll that hides when scrolling down and shows when scrolling up"
    - "User can tap hamburger icon on mobile to open slide-out menu"
    - "User observes magnetic hover effect when cursor approaches CTA button"
    - "User clicks nav link and page smoothly scrolls to target section"
  artifacts:
    - path: "components/ui/magnetic-button.tsx"
      provides: "Magnetic hover wrapper component"
      exports: ["Magnetic"]
    - path: "components/layout/mobile-nav.tsx"
      provides: "Sheet-based mobile navigation"
      exports: ["MobileNav"]
    - path: "components/layout/header-nav.tsx"
      provides: "Client component with scroll detection and navigation"
      exports: ["HeaderNav"]
    - path: "components/layout/header.tsx"
      provides: "Server component shell for header"
      exports: ["Header"]
  key_links:
    - from: "components/layout/header-nav.tsx"
      to: "hooks/use-scroll-direction.ts"
      via: "useScrollDirection import"
      pattern: "useScrollDirection"
    - from: "components/layout/header-nav.tsx"
      to: "components/ui/magnetic-button.tsx"
      via: "Magnetic wrapper around CTA"
      pattern: "<Magnetic>"
    - from: "components/layout/header-nav.tsx"
      to: "components/layout/mobile-nav.tsx"
      via: "MobileNav component inclusion"
      pattern: "<MobileNav"
---

<objective>
Build the complete navigation system including sticky header with scroll-aware hide/show, mobile hamburger menu, magnetic CTA button, and smooth scroll navigation links.

Purpose: Navigation is the primary way users orient themselves on the page and access the waitlist CTA. The auto-hiding behavior prevents nav from consuming space on long pages while keeping it accessible on scroll up.

Output: Magnetic button component, MobileNav (Sheet-based), HeaderNav (scroll-aware client component), and Header (server component shell).
</objective>

<execution_context>
@~/.claude/get-shit-done/workflows/execute-plan.md
@~/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/02-layout-components/02-RESEARCH.md

# From Plan 01
@hooks/use-scroll-direction.ts
@lib/animation-variants.ts
@components/ui/sheet.tsx
@components/ui/button.tsx
@lib/utils.ts
</context>

<tasks>

<task type="auto">
  <name>Task 1: Create Magnetic button wrapper component</name>
  <files>components/ui/magnetic-button.tsx</files>
  <action>
    Create `components/ui/magnetic-button.tsx`:
    - 'use client' directive
    - Import `useRef`, `useState` from 'react'
    - Import `motion` from 'motion/react'
    - Export `Magnetic` component that wraps children

    Implementation:
    - Track mouse position relative to element center
    - Apply 0.3 multiplier for subtle pull effect (not too strong)
    - Use spring transition: stiffness 150, damping 15, mass 0.1
    - Reset position on mouse leave
    - Accept className prop for styling container

    ```typescript
    'use client'

    import { useRef, useState } from 'react'
    import { motion } from 'motion/react'

    interface MagneticProps {
      children: React.ReactNode
      className?: string
    }

    export function Magnetic({ children, className }: MagneticProps) {
      const ref = useRef<HTMLDivElement>(null)
      const [position, setPosition] = useState({ x: 0, y: 0 })

      const handleMouse = (e: React.MouseEvent) => {
        const { clientX, clientY } = e
        const { height, width, left, top } = ref.current!.getBoundingClientRect()
        const middleX = clientX - (left + width / 2)
        const middleY = clientY - (top + height / 2)
        setPosition({ x: middleX * 0.3, y: middleY * 0.3 })
      }

      const reset = () => setPosition({ x: 0, y: 0 })

      return (
        <motion.div
          ref={ref}
          onMouseMove={handleMouse}
          onMouseLeave={reset}
          animate={{ x: position.x, y: position.y }}
          transition={{ type: 'spring', stiffness: 150, damping: 15, mass: 0.1 }}
          className={className}
        >
          {children}
        </motion.div>
      )
    }
    ```
  </action>
  <verify>
    - File exists at components/ui/magnetic-button.tsx
    - `npx tsc --noEmit` passes
  </verify>
  <done>Magnetic component wraps children and applies spring-based cursor-following effect</done>
</task>

<task type="auto">
  <name>Task 2: Create MobileNav with Sheet component</name>
  <files>components/layout/mobile-nav.tsx</files>
  <action>
    Create `components/layout/mobile-nav.tsx`:
    - 'use client' directive
    - Import Sheet components from '@/components/ui/sheet'
    - Import Button from '@/components/ui/button'
    - Import Menu icon from 'lucide-react'
    - Import useState from 'react'

    Props interface:
    ```typescript
    interface NavItem {
      href: string
      label: string
    }

    interface MobileNavProps {
      items: NavItem[]
    }
    ```

    Implementation:
    - Sheet trigger: Button with ghost variant, icon size, Menu icon
    - Sheet opens from left side, width 280px
    - Navigation links with smooth scroll behavior
    - Close sheet when link is clicked (setOpen(false))
    - Include "Join Waitlist" CTA button at bottom of nav
    - Proper aria labels: aria-label="Open navigation menu", aria-expanded

    Smooth scroll handler:
    ```typescript
    const handleNavClick = (href: string) => {
      setOpen(false)
      const id = href.replace('#', '')
      const element = document.getElementById(id)
      if (element) {
        element.scrollIntoView({ behavior: 'smooth' })
        window.history.pushState(null, '', href)
      }
    }
    ```

    IMPORTANT: Only show on mobile (md:hidden on trigger button).
  </action>
  <verify>
    - File exists at components/layout/mobile-nav.tsx
    - `npx tsc --noEmit` passes
  </verify>
  <done>MobileNav renders Sheet with navigation links that close on click and smooth scroll to sections</done>
</task>

<task type="auto">
  <name>Task 3: Create HeaderNav and Header components</name>
  <files>components/layout/header-nav.tsx, components/layout/header.tsx</files>
  <action>
    Create `components/layout/header-nav.tsx` (client component):
    - 'use client' directive
    - Import motion from 'motion/react'
    - Import Link from 'next/link'
    - Import useScrollDirection from '@/hooks/use-scroll-direction'
    - Import MobileNav from './mobile-nav'
    - Import Magnetic from '@/components/ui/magnetic-button'
    - Import Button from '@/components/ui/button'
    - Import cn from '@/lib/utils'
    - Import navVariants, navTransition from '@/lib/animation-variants'

    Navigation items (will be used across page):
    ```typescript
    const navItems = [
      { href: '#how-it-works', label: 'How It Works' },
      { href: '#features', label: 'Features' },
      { href: '#calculator', label: 'Calculator' },
      { href: '#faq', label: 'FAQ' },
    ]
    ```

    Implementation:
    - motion.header with fixed positioning, z-50
    - Use navVariants: hidden when scrollDirection === 'down' && !isAtTop
    - Background: transparent at top, bg-background/80 backdrop-blur-sm border-b when scrolled
    - Container with flex, h-16, items-center, justify-between
    - Logo (Link to "/" with text "Omni Card" or just "Omni" in bold)
    - Desktop nav: hidden md:flex with nav items
    - Each nav link: smooth scroll onClick handler
    - Desktop CTA: Magnetic wrapper around Button "Join Waitlist" (hidden md:block)
    - Mobile: MobileNav component (md:hidden)

    Smooth scroll handler (same pattern):
    ```typescript
    const scrollTo = (href: string) => (e: React.MouseEvent) => {
      e.preventDefault()
      const id = href.replace('#', '')
      document.getElementById(id)?.scrollIntoView({ behavior: 'smooth' })
      window.history.pushState(null, '', href)
    }
    ```

    Create `components/layout/header.tsx` (server component shell):
    - Simply imports and renders HeaderNav
    - Thin wrapper for organizational clarity

    ```typescript
    import { HeaderNav } from './header-nav'

    export function Header() {
      return <HeaderNav />
    }
    ```
  </action>
  <verify>
    - Both files exist at components/layout/header-nav.tsx and header.tsx
    - `npx tsc --noEmit` passes
    - No import errors
  </verify>
  <done>HeaderNav implements auto-hiding sticky nav with desktop links, mobile menu, and magnetic CTA; Header exports server component wrapper</done>
</task>

</tasks>

<verification>
Run after all tasks complete:
1. `npx tsc --noEmit` - no TypeScript errors
2. Check that all 4 files exist:
   - components/ui/magnetic-button.tsx
   - components/layout/mobile-nav.tsx
   - components/layout/header-nav.tsx
   - components/layout/header.tsx
</verification>

<success_criteria>
- Magnetic component applies spring-based cursor tracking to wrapped children
- MobileNav uses Sheet for slide-out menu, closes on link click, includes smooth scroll
- HeaderNav auto-hides on scroll down, shows on scroll up, transparent at top
- Desktop nav shows links and magnetic CTA, mobile shows hamburger menu
- Header exports clean server component wrapper
- All TypeScript compiles without errors
</success_criteria>

<output>
After completion, create `.planning/phases/02-layout-components/02-02-SUMMARY.md`
</output>
