---
phase: 02-layout-components
plan: 01
type: execute
wave: 1
depends_on: []
files_modified:
  - package.json
  - package-lock.json
  - components/ui/sheet.tsx
  - hooks/use-scroll-direction.ts
  - lib/animation-variants.ts
  - app/layout.tsx
autonomous: true

must_haves:
  truths:
    - "Motion library is available for import in any component"
    - "useScrollDirection hook returns scroll direction and isAtTop state"
    - "MotionConfig respects user's reduced motion preference"
  artifacts:
    - path: "hooks/use-scroll-direction.ts"
      provides: "Scroll direction detection hook"
      exports: ["useScrollDirection"]
    - path: "lib/animation-variants.ts"
      provides: "Centralized animation variants"
      exports: ["navVariants"]
    - path: "components/ui/sheet.tsx"
      provides: "shadcn Sheet component for mobile menu"
  key_links:
    - from: "app/layout.tsx"
      to: "motion/react"
      via: "MotionConfig wrapper"
      pattern: "MotionConfig.*reducedMotion"
---

<objective>
Install animation dependencies and create reusable animation infrastructure for Phase 2 navigation and footer components.

Purpose: Motion library enables scroll-aware navigation hide/show, spring physics for magnetic buttons, and reduced motion support. The useScrollDirection hook and animation variants will be shared across Header and future scroll-linked components.

Output: Installed packages (motion, react-social-icons), shadcn Sheet component, useScrollDirection hook, animation-variants.ts, and MotionConfig in layout.
</objective>

<execution_context>
@~/.claude/get-shit-done/workflows/execute-plan.md
@~/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/02-layout-components/02-RESEARCH.md

# Existing files to reference
@app/layout.tsx
@lib/utils.ts
</context>

<tasks>

<task type="auto">
  <name>Task 1: Install dependencies and add shadcn Sheet</name>
  <files>package.json, package-lock.json, components/ui/sheet.tsx</files>
  <action>
    Install motion and react-social-icons packages:
    ```bash
    npm install motion react-social-icons
    ```

    Add shadcn Sheet component (for mobile nav):
    ```bash
    npx shadcn@latest add sheet
    ```

    IMPORTANT: Motion is imported from `motion/react`, not `framer-motion`. The package is named `motion` but imports come from `motion/react`.
  </action>
  <verify>
    - `npm ls motion` shows motion installed
    - `npm ls react-social-icons` shows react-social-icons installed
    - `components/ui/sheet.tsx` exists
  </verify>
  <done>Dependencies installed and Sheet component available at components/ui/sheet.tsx</done>
</task>

<task type="auto">
  <name>Task 2: Create useScrollDirection hook</name>
  <files>hooks/use-scroll-direction.ts</files>
  <action>
    Create `hooks/use-scroll-direction.ts` with:
    - 'use client' directive at top
    - Import `useScroll`, `useMotionValueEvent` from `motion/react`
    - Import `useState` from 'react'
    - Export `useScrollDirection` function that returns:
      - `scrollDirection`: 'up' | 'down'
      - `isAtTop`: boolean (true when scrollY < 10)
      - `scrollY`: MotionValue<number>
    - Use `useMotionValueEvent` to track scroll changes
    - Only update direction if scroll diff > 10 (prevents jitter)
    - Use `scrollY.getPrevious()` to get previous value (avoids stale closure)

    Pattern from research:
    ```typescript
    'use client'
    import { useScroll, useMotionValueEvent } from 'motion/react'
    import { useState } from 'react'

    export function useScrollDirection() {
      const { scrollY } = useScroll()
      const [scrollDirection, setScrollDirection] = useState<'up' | 'down'>('up')
      const [isAtTop, setIsAtTop] = useState(true)

      useMotionValueEvent(scrollY, 'change', (current) => {
        const previous = scrollY.getPrevious() ?? 0
        const diff = current - previous
        setIsAtTop(current < 10)
        if (Math.abs(diff) > 10) {
          setScrollDirection(diff > 0 ? 'down' : 'up')
        }
      })

      return { scrollDirection, isAtTop, scrollY }
    }
    ```
  </action>
  <verify>
    - File exists at hooks/use-scroll-direction.ts
    - TypeScript compiles without errors: `npx tsc --noEmit`
  </verify>
  <done>useScrollDirection hook exports scrollDirection, isAtTop, and scrollY values</done>
</task>

<task type="auto">
  <name>Task 3: Create animation variants and add MotionConfig to layout</name>
  <files>lib/animation-variants.ts, app/layout.tsx</files>
  <action>
    Create `lib/animation-variants.ts`:
    - Navigation show/hide variants (y: '0%' / y: '-100%')
    - Standard transition timing (duration: 0.2, ease: 'easeInOut')

    ```typescript
    // Navigation hide/show variants
    export const navVariants = {
      visible: { y: '0%' },
      hidden: { y: '-100%' },
    }

    export const navTransition = {
      duration: 0.2,
      ease: 'easeInOut' as const,
    }
    ```

    Update `app/layout.tsx`:
    - Add 'use client' directive (required for MotionConfig)
    - Import `MotionConfig` from 'motion/react'
    - Wrap children in `<MotionConfig reducedMotion="user">` inside body
    - Keep all existing code (Inter font, metadata export)

    IMPORTANT: Since we're adding 'use client', we need to handle metadata differently. Move metadata to a separate metadata.ts file or use generateMetadata. Actually, Next.js allows metadata in client components if it's a static export - but best practice is to keep layout as server component.

    REVISED APPROACH: Create a separate providers component:
    - Create `components/providers.tsx` as client component with MotionConfig
    - Keep layout.tsx as server component
    - Wrap children with Providers in layout

    ```typescript
    // components/providers.tsx
    'use client'
    import { MotionConfig } from 'motion/react'

    export function Providers({ children }: { children: React.ReactNode }) {
      return (
        <MotionConfig reducedMotion="user">
          {children}
        </MotionConfig>
      )
    }
    ```

    Then update layout.tsx to import and use Providers wrapper around {children}.
  </action>
  <verify>
    - `lib/animation-variants.ts` exists with navVariants and navTransition exports
    - `components/providers.tsx` exists with MotionConfig
    - `app/layout.tsx` imports and uses Providers
    - `npm run build` succeeds (or `npm run dev` runs without errors)
  </verify>
  <done>Animation variants centralized, MotionConfig respects prefers-reduced-motion via Providers component</done>
</task>

</tasks>

<verification>
Run after all tasks complete:
1. `npm ls motion react-social-icons` - both packages listed
2. `npx tsc --noEmit` - no TypeScript errors
3. `npm run dev` - dev server starts without errors
4. Check http://localhost:3000 - page loads normally
</verification>

<success_criteria>
- motion and react-social-icons installed in package.json
- shadcn Sheet component at components/ui/sheet.tsx
- useScrollDirection hook at hooks/use-scroll-direction.ts exports { scrollDirection, isAtTop, scrollY }
- navVariants and navTransition exported from lib/animation-variants.ts
- Providers component wraps app with MotionConfig reducedMotion="user"
- App builds and runs without errors
</success_criteria>

<output>
After completion, create `.planning/phases/02-layout-components/02-01-SUMMARY.md`
</output>
